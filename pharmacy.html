<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacy - Prince Alex Hospital HMS</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBYfTWtl-N21DxVATxVnhCofgQsVu3xK4M",
            authDomain: "store-e88d9.firebaseapp.com",
            projectId: "store-e88d9",
            storageBucket: "store-e88d9.firebasestorage.app",
            messagingSenderId: "30797525855",
            appId: "1:30797525855:web:335287605ec648f747fcea"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Make Firebase available globally
        window.firebaseApp = app;
        window.firebaseDb = db;
        window.firebaseAuth = auth;
    </script>
</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>üè• Prince Alex Hospital</h1>
                <h2>Hospital Management System (HMS)</h2>
            </div>
            <div class="user-info">
                <h3 class="welcome-message">Welcome User</h3>
                <p>Department</p>
            </div>
        </div>
        
        <div class="main-content">
            <div class="content-header">
                <h1>üíä Pharmacy</h1>
                <p>Manage prescriptions, dispense medications, and inventory</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    Pending Prescriptions
                </div>
                <div class="card-body">
                    <div class="search-container">
                        <input type="text" id="searchPrescriptions" class="search-input" placeholder="Search prescriptions...">
                        <select id="filterPrescriptions" class="filter-select">
                            <option value="">All Prescriptions</option>
                            <option value="pending">Pending</option>
                            <option value="dispensed">Dispensed</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    <div id="prescriptionsTable">
                        <!-- Prescriptions table will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    Medicine Inventory
                </div>
                <div class="card-body">
                    <div class="search-container">
                        <input type="text" id="searchMedicines" class="search-input" placeholder="Search medicines...">
                        <select id="filterMedicines" class="filter-select">
                            <option value="">All Medicines</option>
                            <option value="low_stock">Low Stock</option>
                            <option value="out_of_stock">Out of Stock</option>
                        </select>
                        <button class="btn btn-primary" onclick="openAddMedicineModal()">Add Medicine</button>
                    </div>
                    <div id="medicinesTable">
                        <!-- Medicines table will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Dispense Prescription Modal -->
    <div id="dispenseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h2>Dispense Prescription</h2>
            </div>
            <div class="modal-body">
                <form id="dispenseForm">
                    <input type="hidden" id="dispensePrescriptionId">
                    <input type="hidden" id="dispensePatientId">
                    <input type="hidden" id="dispensePatientName">
                    
                    <div class="patient-info" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h3>Prescription Details</h3>
                        <p><strong>Patient:</strong> <span id="modalPatientName"></span></p>
                        <p><strong>Medication:</strong> <span id="modalMedication"></span></p>
                        <p><strong>Dosage:</strong> <span id="modalDosage"></span></p>
                        <p><strong>Frequency:</strong> <span id="modalFrequency"></span></p>
                        <p><strong>Duration:</strong> <span id="modalDuration"></span></p>
                        <p><strong>Prescribed By:</strong> <span id="modalDoctor"></span></p>
                    </div>
                    
                    <div class="form-group">
                        <label for="quantityDispensed">Quantity Dispensed:</label>
                        <input type="number" id="quantityDispensed" min="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="batchNumber">Batch Number:</label>
                        <input type="text" id="batchNumber" placeholder="Enter batch number">
                    </div>
                    
                    <div class="form-group">
                        <label for="expiryDate">Expiry Date:</label>
                        <input type="date" id="expiryDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="dispenseNotes">Dispense Notes:</label>
                        <textarea id="dispenseNotes" rows="3" placeholder="Additional notes for the patient..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeDispenseModal()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="dispensePrescription()">Dispense</button>
            </div>
        </div>
    </div>
    
    <!-- Add Medicine Modal -->
    <div id="addMedicineModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h2>Add Medicine</h2>
            </div>
            <div class="modal-body">
                <form id="addMedicineForm">
                    <div class="form-group">
                        <label for="medicineName">Medicine Name:</label>
                        <input type="text" id="medicineName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="medicineType">Medicine Type:</label>
                        <select id="medicineType" required>
                            <option value="">Select Type</option>
                            <option value="Tablet">Tablet</option>
                            <option value="Capsule">Capsule</option>
                            <option value="Syrup">Syrup</option>
                            <option value="Injection">Injection</option>
                            <option value="Cream">Cream</option>
                            <option value="Drops">Drops</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="medicineStrength">Strength:</label>
                        <input type="text" id="medicineStrength" placeholder="e.g., 500mg, 10ml">
                    </div>
                    
                    <div class="form-group">
                        <label for="medicineQuantity">Current Quantity:</label>
                        <input type="number" id="medicineQuantity" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="medicineMinStock">Minimum Stock Level:</label>
                        <input type="number" id="medicineMinStock" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="medicinePrice">Unit Price:</label>
                        <input type="number" id="medicinePrice" min="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="medicineSupplier">Supplier:</label>
                        <input type="text" id="medicineSupplier" placeholder="Supplier name">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeAddMedicineModal()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addMedicine()">Add Medicine</button>
            </div>
        </div>
    </div>
    
    <script src="firebase-auth.js"></script>
    <script src="shared.js"></script>
    <script src="pharmacy.js"></script>
</body>
</html>
